"""
Bot å‘½ä»¤é…ç½® - Bot Commands
é›†ä¸­ç®¡ç†æ‰€æœ‰ Telegram å‘½ä»¤åŠå…¶æè¿°
"""

# ==========================================
# Bot å‘½ä»¤èœå•é…ç½®
# ==========================================
# å‘½ä»¤æ ¼å¼: (å‘½ä»¤, æè¿°)
# æè¿°é™åˆ¶: 1-256 å­—ç¬¦ï¼ˆå»ºè®®æ§åˆ¶åœ¨ 30 å­—ç¬¦ä»¥å†…ä»¥ä¿è¯æ˜¾ç¤ºæ•ˆæœï¼‰
#
# ç»Ÿä¸€é£æ ¼è§„èŒƒï¼š
# - ä½¿ç”¨ âœ¨ ğŸ° âš”ï¸ ç­‰ emoji å¢å¼ºè¯†åˆ«åº¦
# - æè¿°ç®€æ´æ˜äº†ï¼Œçªå‡ºæ ¸å¿ƒåŠŸèƒ½
# - åŒç±»å‘½ä»¤åˆ†ç»„æ’åˆ—
# ==========================================

BOT_COMMANDS = [
    # === åŸºç¡€å‘½ä»¤ ===
    ("start", "âœ¨ å¼€å§‹å†’é™© - æŸ¥çœ‹ä¸»èœå•"),
    ("menu", "ğŸ“‹ åŠŸèƒ½èœå•"),
    ("help", "ğŸ“– å¸®åŠ©æ‰‹å†Œ"),
    ("tutorial", "ğŸ“ æ–°æ‰‹æ•™ç¨‹"),

    # === è´¦å·ç›¸å…³ ===
    ("bind", "ğŸ”— ç»‘å®šè´¦å·"),
    ("me", "ğŸ‘¤ ä¸ªäººæ¡£æ¡ˆ"),
    ("bank", "ğŸ¦ é­”æ³•é“¶è¡Œ"),

    # === æ¯æ—¥åŠŸèƒ½ ===
    ("checkin", "ğŸ“… æ¯æ—¥ç­¾åˆ°"),
    ("calendar", "ğŸ“† ç­¾åˆ°æ—¥å†"),
    ("mission", "ğŸ“œ æ¯æ—¥ä»»åŠ¡"),
    ("wheel", "ğŸ° å¹¸è¿è½¬ç›˜"),
    ("chest", "ğŸ VIPå®ç®±"),

    # === ç©æ³•ç³»ç»Ÿ ===
    ("poster", "ğŸ¬ å‘½è¿ç›²ç›’"),
    ("fate", "ğŸ¬ å‘½è¿ç›²ç›’"),
    ("forge", "âš’ï¸ é”»é€ æ­¦å™¨"),
    ("duel", "âš”ï¸ é­”æ³•å†³æ–—"),
    ("aiduel", "ğŸ¤– AIæŒ‘æˆ˜"),
    ("tower", "ğŸ—¼ é€šå¤©å¡”"),
    ("breakthrough", "ğŸ’ª æˆ˜åŠ›çªç ´"),

    # === å•†åŸç³»ç»Ÿ ===
    ("shop", "ğŸ›ï¸ é­”æ³•å•†åº—"),
    ("bag", "ğŸ’ æˆ‘çš„èƒŒåŒ…"),
    ("cosmetics", "ğŸ¨ å¤–è§‚å•†åº—"),

    # === ç¤¾äº¤ç³»ç»Ÿ ===
    ("guild", "ğŸ° å…¬ä¼šç³»ç»Ÿ"),
    ("hall", "ğŸ† è£è€€æ®¿å ‚"),
    ("rank", "ğŸ“Š æ´»è·ƒæ’è¡Œ"),

    # === Emby å½±éŸ³ ===
    ("new", "ğŸ†• æœ€æ–°ä¸Šçº¿"),
    ("recommend", "ğŸ¬ ç”µå½±æ¨è"),
    ("watch_status", "ğŸ¬ è§‚å½±çŠ¶æ€"),
    ("weekly_watch", "ğŸ† è§‚å½±æ’è¡Œ"),

    # === æˆå°±ä¸è¿›åº¦ ===
    ("achievement", "ğŸ… æˆå°±åˆ—è¡¨"),
    ("progress", "ğŸ“ˆ è¿›åº¦é¢„å‘Š"),

    # === VIP ç³»ç»Ÿ ===
    ("vip", "ğŸ‘‘ VIPä¸­å¿ƒ"),

    # === çº¢åŒ…ä¸ç¤¼ç‰© ===
    ("redpacket", "ğŸ§§ å‘é€çº¢åŒ…"),
    ("gift", "ğŸ è½¬èµ é­”åŠ›"),
]

# ==========================================
# å‘½ä»¤åˆ†ç»„ï¼ˆç”¨äºå¸®åŠ©æ–‡æ¡£ï¼‰
# ==========================================

COMMAND_GROUPS = {
    "åŸºç¡€": {
        "emoji": "âœ¨",
        "commands": [
            ("start", "å¼€å§‹å†’é™©ï¼ŒæŸ¥çœ‹ä¸»èœå•"),
            ("menu", "æ‰“å¼€åŠŸèƒ½èœå•"),
            ("help", "æŸ¥çœ‹å¸®åŠ©æ‰‹å†Œ"),
            ("tutorial", "æ–°æ‰‹æ•™ç¨‹"),
        ]
    },
    "è´¦å·": {
        "emoji": "ğŸ‘¤",
        "commands": [
            ("bind", "ç»‘å®š Emby è´¦å·"),
            ("me", "æŸ¥çœ‹ä¸ªäººæ¡£æ¡ˆé¢æ¿"),
            ("my", "æŸ¥çœ‹ä¸ªäººæ¡£æ¡ˆé¢æ¿"),
            ("bank", "é­”æ³•é“¶è¡Œå­˜å–æ¬¾"),
        ]
    },
    "æ¯æ—¥": {
        "emoji": "ğŸ“…",
        "commands": [
            ("checkin", "æ¯æ—¥ç­¾åˆ°é¢†å–é­”åŠ›"),
            ("daily", "æ¯æ—¥ç­¾åˆ°é¢†å–é­”åŠ›"),
            ("calendar", "æŸ¥çœ‹ç­¾åˆ°æ—¥å†"),
            ("checkin_calendar", "æŸ¥çœ‹ç­¾åˆ°æ—¥å†"),
            ("mission", "æŸ¥çœ‹æ¯æ—¥ä»»åŠ¡"),
            ("wheel", "å¹¸è¿è½¬ç›˜æŠ½å¥–"),
            ("lucky", "å¹¸è¿è½¬ç›˜æŠ½å¥–"),
            ("spin", "å¹¸è¿è½¬ç›˜æŠ½å¥–"),
            ("chest", "å¼€å¯ VIP å®ç®±"),
        ]
    },
    "ç©æ³•": {
        "emoji": "ğŸ®",
        "commands": [
            ("poster", "å‘½è¿ç›²ç›’æŠ½ç”µå½±"),
            ("fate", "å‘½è¿ç›²ç›’æŠ½ç”µå½±"),
            ("forge", "é”»é€ é­”æ³•æ­¦å™¨"),
            ("weapon", "é”»é€ é­”æ³•æ­¦å™¨"),
            ("myweapon", "æŸ¥çœ‹æˆ‘çš„æ­¦å™¨"),
            ("collection", "æ­¦å™¨æ”¶è—"),
            ("duel", "å‘èµ·é­”æ³•å†³æ–—"),
            ("duelstats", "æŸ¥çœ‹å†³æ–—ç»Ÿè®¡"),
            ("aiduel", "AI æŒ‘æˆ˜åˆ—è¡¨"),
            ("tower", "é€šå¤©å¡”æŒ‘æˆ˜"),
            ("breakthrough", "æˆ˜åŠ›çªç ´"),
        ]
    },
    "å•†åŸ": {
        "emoji": "ğŸ›ï¸",
        "commands": [
            ("shop", "é­”æ³•å•†åº—"),
            ("store", "é­”æ³•å•†åº—"),
            ("bag", "æŸ¥çœ‹èƒŒåŒ…"),
            ("items", "æŸ¥çœ‹èƒŒåŒ…"),
            ("cosmetics", "å¤–è§‚å•†åº—"),
        ]
    },
    "ç¤¾äº¤": {
        "emoji": "ğŸ‘¥",
        "commands": [
            ("guild", "å…¬ä¼šç³»ç»Ÿ"),
            ("guilds", "å…¬ä¼šç³»ç»Ÿ"),
            ("hall", "è£è€€æ®¿å ‚"),
            ("rank", "æ´»è·ƒåº¦æ’è¡Œ"),
            ("presence", "åœ¨çº¿çŠ¶æ€"),
            ("active", "åœ¨çº¿çŠ¶æ€"),
        ]
    },
    "å½±éŸ³": {
        "emoji": "ğŸ¬",
        "commands": [
            ("emby_list", "Emby åª’ä½“åº“"),
            ("new", "æœ€æ–°ä¸Šçº¿"),
            ("new_release", "æ–°ç‰‡æ¨è"),
            ("recommend", "ç”µå½±æ¨è"),
            ("movie", "ç”µå½±æ¨è"),
            ("watch_status", "è§‚å½±çŠ¶æ€"),
            ("watch_rank", "è§‚å½±æ’è¡Œ"),
            ("weekly_watch", "è§‚å½±æ’è¡Œ"),
            ("watch_stats", "è§‚å½±ç»Ÿè®¡"),
            ("my_stats", "è§‚å½±ç»Ÿè®¡"),
            ("watch_achievements", "è§‚å½±æˆå°±"),
            ("early_bird", "æ—©é¸ŸæŒ‘æˆ˜"),
            ("weekly_challenge", "æ¯å‘¨æŒ‘æˆ˜"),
        ]
    },
    "æˆå°±": {
        "emoji": "ğŸ…",
        "commands": [
            ("achievement", "æˆå°±åˆ—è¡¨"),
            ("achievements", "æˆå°±åˆ—è¡¨"),
            ("ach", "æˆå°±åˆ—è¡¨"),
            ("titles", "æˆ‘çš„ç§°å·"),
            ("mytitles", "æˆ‘çš„ç§°å·"),
        ]
    },
    "VIP": {
        "emoji": "ğŸ‘‘",
        "commands": [
            ("vip", "VIP ä¸­å¿ƒ"),
            ("vipcenter", "VIP ä¸­å¿ƒ"),
            ("applyvip", "ç”³è¯· VIP"),
            ("vip_benefit", "VIP è§‚å½±æƒç›Š"),
        ]
    },
    "å…¶ä»–": {
        "emoji": "ğŸ”§",
        "commands": [
            ("redpacket", "å‘é€çº¢åŒ…"),
            ("hongbao", "å‘é€çº¢åŒ…"),
            ("rpstatus", "çº¢åŒ…çŠ¶æ€"),
            ("gift", "è½¬èµ é­”åŠ›"),
            ("progress", "è¿›åº¦é¢„å‘Š"),
            ("airdrop", "å¹¸è¿ç©ºæŠ•"),
            ("push", "æœ‰å¥–æ¨é€"),
            ("announce", "ç¾¤ç»„å…¬å‘Š"),
        ]
    },
}


# ==========================================
# ç®¡ç†å‘˜å‘½ä»¤ï¼ˆä¸æ˜¾ç¤ºåœ¨èœå•ä¸­ï¼‰
# ==========================================

ADMIN_COMMANDS = [
    ("admin", "ç®¡ç†å‘˜é¢æ¿"),
    ("sync", "åŒæ­¥ç”¨æˆ·æ•°æ®"),
    ("query", "æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯"),
    ("addpoints", "å¢åŠ ç§¯åˆ†"),
    ("delpoints", "æ‰£é™¤ç§¯åˆ†"),
    ("setvip", "è®¾ç½® VIP"),
    ("unvip", "å–æ¶ˆ VIP"),
    ("say", "æœºå™¨äººå‘è¨€"),
]


# ==========================================
# å‘½ä»¤åˆ«åæ˜ å°„
# ==========================================

COMMAND_ALIASES = {
    # ä¸ªäººæ¡£æ¡ˆåˆ«å
    "my": "me",

    # ç­¾åˆ°åˆ«å
    "daily": "checkin",
    "checkin_calendar": "calendar",

    # è½¬ç›˜åˆ«å
    "lucky": "wheel",
    "spin": "wheel",

    # å•†åº—åˆ«å
    "store": "shop",
    "buy": "shop",

    # èƒŒåŒ…åˆ«å
    "items": "bag",

    # é”»é€ åˆ«å
    "weapon": "forge",

    # æˆå°±åˆ«å
    "achievements": "achievement",
    "ach": "achievement",

    # ç§°å·åˆ«å
    "mytitles": "titles",

    # å…¬ä¼šåˆ«å
    "guilds": "guild",

    # æ’è¡Œåˆ«å
    "active": "presence",

    # VIP åˆ«å
    "vipcenter": "vip",

    # çº¢åŒ…åˆ«å
    "hongbao": "redpacket",

    # å†³æ–—ç»Ÿè®¡åˆ«å
    "duelstats": "aiduel",
}


# ==========================================
# è·å–å‘½ä»¤æè¿°çš„è¾…åŠ©å‡½æ•°
# ==========================================

def get_command_description(command: str) -> str:
    """è·å–å‘½ä»¤æè¿°"""
    for cmd, desc in BOT_COMMANDS:
        if cmd == command:
            return desc
    # æ£€æŸ¥åˆ«å
    if command in COMMAND_ALIASES:
        main_cmd = COMMAND_ALIASES[command]
        return get_command_description(main_cmd)
    return ""


def get_all_commands_list() -> list:
    """è·å–æ‰€æœ‰å‘½ä»¤åˆ—è¡¨ï¼ˆå»é‡ï¼‰"""
    seen = set()
    result = []
    for cmd, desc in BOT_COMMANDS:
        if cmd not in seen:
            seen.add(cmd)
            result.append((cmd, desc))
    return result


def format_help_text() -> str:
    """æ ¼å¼åŒ–å¸®åŠ©æ–‡æœ¬"""
    lines = [
        "âœ¨ <b>ã€ é­” æ³• å°‘ å¥³ æŒ‡ å— ã€‘</b>",
        "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”",
        ""
    ]

    for group_name, group_data in COMMAND_GROUPS.items():
        lines.append(f"{group_data['emoji']} <b>{group_name}åŠŸèƒ½</b>")
        for cmd, desc in group_data['commands']:
            lines.append(f"  /{cmd} - {desc}")
        lines.append("")

    lines.extend([
        "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”",
        "<i>\"è¾“å…¥ /start å¼€å¯å†’é™©ä¹‹æ—…ï¼\"</i>"
    ])

    return "\n".join(lines)
